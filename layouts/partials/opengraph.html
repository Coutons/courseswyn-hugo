{{- /* OpenGraph and Twitter Card */ -}}
{{- $s := .Site -}}
{{- $title := .Title -}}
{{- $summary := .Summary | plainify | chomp -}}
{{- $description := or .Description $summary -}}
{{- $description = $description | plainify | chomp -}}
{{- $descriptionMax := 180 -}}
{{- if gt (len $description) $descriptionMax -}}
  {{- $description = truncate $descriptionMax $description -}}
{{- end -}}
{{- $permalink := .Permalink -}}
{{- $baseURL := strings.TrimSuffix "/" $s.BaseURL -}}

{{- /* Resolve best image candidate */ -}}
{{- $imageCandidates := slice .Params.featureImage .Params.thumbnail .Params.shareImage .Params.image $s.Params.featureImage -}}
{{- $image := "" -}}
{{- range $imageCandidates -}}
  {{- if and (not $image) . -}}
    {{- $image = . -}}
  {{- end -}}
{{- end -}}
{{- if not $image -}}
  {{- $image = "images/twitter-card.jpg" -}}
{{- end -}}

{{- if and $image (not (hasPrefix (lower $image) "http")) -}}
  {{- $image = printf "%s/%s" $baseURL (strings.TrimPrefix "/" $image) -}}
{{- end -}}
{{- $imageAlt := .Params.imageAlt | default .Title -}}

{{- /* Basic Meta */ -}}
<meta name="description" content="{{ $description }}">

{{- /* OpenGraph */ -}}
<meta property="og:title" content="{{ $title }}" />
<meta property="og:description" content="{{ $description }}" />
<meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}" />
<meta property="og:url" content="{{ $permalink }}" />

{{- /* Twitter Card */ -}}
<meta name="twitter:card" content="summary_large_image">
{{- $twitterHandle := "courseswyn" -}}
<meta name="twitter:site" content="@{{ $twitterHandle }}">
<meta name="twitter:creator" content="@{{ $twitterHandle }}">
<meta name="twitter:title" content="{{ $title }}">
<meta name="twitter:description" content="{{ $description }}">

{{- /* Twitter Image */ -}}
{{- $twitterImage := $image -}}
{{- if and $twitterImage (not (hasPrefix (lower $twitterImage) "http")) -}}
  {{- $twitterImage = printf "%s/%s" $baseURL (strings.TrimPrefix "/" $twitterImage) -}}
{{- end -}}

{{- /* Output the Twitter image meta tag */ -}}
<meta name="twitter:image" content="{{ $twitterImage }}">
<meta name="twitter:image:alt" content="{{ with .Params.imageAlt }}{{ . }}{{ else }}{{ $title }}{{ end }}">

{{- /* OpenGraph Image */ -}}
{{- $ogImage := $image -}}
{{- if and $ogImage (not (hasPrefix (lower $ogImage) "http")) -}}
  {{- $ogImage = printf "%s/%s" $baseURL (strings.TrimPrefix "/" $ogImage) -}}
{{- end -}}

{{- with $ogImage -}}
  <meta property="og:image" content="{{ . }}" />
  <meta property="og:image:alt" content="{{ $imageAlt }}" />
  {{- /* Menghapus imageConfig yang menyebabkan error */ -}}
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
{{- end -}}

{{- /* Article specific */ -}}
{{- if .IsPage -}}
  <meta property="article:published_time" content="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
  {{- with .Lastmod }}
    <meta property="article:modified_time" content="{{ .Format "2006-01-02T15:04:05Z07:00" }}">
  {{- end }}
  {{- with .Params.author }}
    <meta property="article:author" content="{{ . }}">
  {{- end }}
  {{- with .Params.section }}
    <meta property="article:section" content="{{ . }}">
  {{- end }}
  {{- range .Params.tags }}
    <meta property="article:tag" content="{{ . }}">
  {{- end }}
{{- end -}}

